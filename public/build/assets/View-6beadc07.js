import{k as d,C as u,o as p,d as m,n as w,c as C,w as c,a as e,f,t as a,h as y,e as h,g as v,F as _,b,u as S}from"./app-c8bd91ed.js";import{_ as $}from"./AppLayout-382544cf.js";import{_ as g}from"./Modal-d6258a4a.js";import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";const k={subpremise:"short_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name"},P=["locality","administrative_area_level_3"],x=["locality","sublocality","postal_code","country","administrative_area_level_1","administrative_area_level_2"],D=["address_components","adr_address","alt_id","formatted_address","geometry","icon","id","name","business_status","photo","place_id","scope","type","url","utc_offset_minutes","vicinity"],A={name:"VueGoogleAutocomplete",props:{id:{type:String,required:!0},classname:String,placeholder:{type:String,default:"Start typing"},disabled:{type:Boolean,default:!1},types:{type:String,default:"address"},fields:{type:Array,default:function(){return D}},country:{type:[String,Array],default:null},enableGeolocation:{type:Boolean,default:!1},geolocationOptions:{type:Object,default:null}},data(){return{autocomplete:null,autocompleteText:"",geolocation:{geocoder:null,loc:null,position:null}}},watch:{autocompleteText:function(n,l){this.$emit("inputChange",{newVal:n,oldVal:l},this.id)},country:function(n,l){this.autocomplete.setComponentRestrictions({country:this.country===null?[]:this.country})}},mounted:function(){const n={};this.types&&(n.types=[this.types]),this.country&&(n.componentRestrictions={country:this.country}),this.autocomplete=new google.maps.places.Autocomplete(document.getElementById(this.id),n),this.autocomplete.setFields(this.fields),this.autocomplete.addListener("place_changed",this.onPlaceChanged)},methods:{onPlaceChanged(){let n=this.autocomplete.getPlace();if(!n.geometry){this.$emit("no-results-found",n,this.id);return}n.address_components!==void 0&&(this.$emit("placechanged",this.formatResult(n),n,this.id),this.autocompleteText=document.getElementById(this.id).value,this.onChange())},onFocus(){this.biasAutocompleteLocation(),this.$emit("focus")},onBlur(){this.$emit("blur")},onChange(){this.$emit("change",this.autocompleteText)},onKeyPress(n){this.$emit("keypress",n)},onKeyUp(n){this.$emit("keyup",n)},clear(){this.autocompleteText=""},focus(){this.$refs.autocomplete.focus()},blur(){this.$refs.autocomplete.blur()},update(n){this.autocompleteText=n},updateCoordinates(n){!n&&!(n.lat||n.lng)||(this.geolocation.geocoder||(this.geolocation.geocoder=new google.maps.Geocoder),this.geolocation.geocoder.geocode({location:n},(l,i)=>{i==="OK"?(l=this.filterGeocodeResultTypes(l),l[0]?(this.$emit("placechanged",this.formatResult(l[0]),l[0],this.id),this.update(l[0].formatted_address)):this.$emit("error","no result for provided coordinates")):this.$emit("error","error getting address from coords")}))},geolocate(){this.updateGeolocation((n,l)=>{this.updateCoordinates(n)})},updateGeolocation(n=null){if(navigator.geolocation){let l={};this.geolocationOptions&&Object.assign(l,this.geolocationOptions),navigator.geolocation.getCurrentPosition(i=>{let t={lat:i.coords.latitude,lng:i.coords.longitude};this.geolocation.loc=t,this.geolocation.position=i,n&&n(t,i)},i=>{this.$emit("error","Cannot get Coordinates from navigator",i)},l)}},biasAutocompleteLocation(){this.enableGeolocation&&this.updateGeolocation((n,l)=>{let i=new google.maps.Circle({center:n,radius:l.coords.accuracy});this.autocomplete.setBounds(i.getBounds())})},formatResult(n){let l={};for(let i=0;i<n.address_components.length;i++){let t=n.address_components[i].types[0];if(k[t]){let s=n.address_components[i][k[t]];l[t]=s}}return l.latitude=n.geometry.location.lat(),l.longitude=n.geometry.location.lng(),l},filterGeocodeResultTypes(n){if(!n||!this.types)return n;let l=[],i=[this.types];i.includes("(cities)")&&(i=i.concat(P)),i.includes("(regions)")&&(i=i.concat(x));for(let t of n)for(let s of t.types)if(i.includes(s)){l.push(t);break}return l}}},V=["id","placeholder","disabled"];function T(n,l,i,t,s,o){return d((p(),m("input",{ref:"autocomplete",type:"text",class:w(i.classname),id:i.id,placeholder:i.placeholder,disabled:i.disabled,"onUpdate:modelValue":l[0]||(l[0]=r=>s.autocompleteText=r),onFocus:l[1]||(l[1]=r=>o.onFocus()),onBlur:l[2]||(l[2]=r=>o.onBlur()),onChange:l[3]||(l[3]=(...r)=>o.onChange&&o.onChange(...r)),onKeypress:l[4]||(l[4]=(...r)=>o.onKeyPress&&o.onKeyPress(...r)),onKeyup:l[5]||(l[5]=(...r)=>o.onKeyUp&&o.onKeyUp(...r))},null,42,V)),[[u,s.autocompleteText]])}const U=E(A,[["render",T]]),B=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Route Info ",-1),R={class:"py-12"},I={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},N={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-4"},j={class:"flex justify-between"},G=e("b",null," Route: ",-1),O=["href"],z=e("label",{for:"name"},"Route Name",-1),K=e("div",null,[e("button",{type:"submit",class:"bg-blue-600"}," Save ")],-1),F={class:"flex justify-between my-6"},L=e("h1",null,[e("b",null," Stops ")],-1),M={class:"mb-6 border p-4 rounded shadow-sm flex flex-col space-y-4 max-w-xl"},Y={class:"flex flex-col items-center space-y-2"},q=e("b",null," Stop: ",-1),W={key:0},Z=e("b",null,"Name:",-1),H={class:"flex justify-between space-x-2"},J=["onClick"],Q=["onClick"],X=["onClick"],ee=e("p",null,[e("b",null," Address: ")],-1),te=["href"],oe={class:"flex space-x-4"},se=["onClick"],ne={class:"my-2 flex items-center space-x-2 flex-wrap"},le=["onClick"],ie=["href"],re={class:"flex space-x-4"},ae=["onClick"],de=e("b",null,"Latest:",-1),ue={class:"flex items-center justify-between p-4"},pe=e("h2",{class:"text-xl"},"Add Stop",-1),me={key:0,class:"p-4 flex space-x-4"},ce=e("p",null,"Are you sure you want to delete this stop?",-1),fe={class:"flex flex-row space-x-4"},he={class:"w-8/12"},be=e("label",{for:"name"},"Name",-1),ye={class:"w-4/12"},ge=e("label",{for:"order"},"Order",-1),ve=e("label",{for:"map"},"Search Address",-1),_e=e("label",{for:"street"},"Street",-1),ke=e("label",{for:"street"},"Apt #",-1),we={class:"flex flex-row space-x-4"},Ce={class:"w-8/12"},Se=e("label",{for:"city"},"City",-1),$e={class:"w-4/12"},Ee=e("label",{for:"state"},"State",-1),Pe=e("label",{for:"zip"},"Zip",-1),xe={class:"flex flex-row justify-end"},De=e("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-700"}," Add Stop ",-1),Ae=e("h2",{class:"text-xl p-4"},"Contact",-1),Ve=e("label",{for:"first_name"},"First Name",-1),Te=e("label",{for:"last_name"},"Last Name",-1),Ue=e("label",{for:"phone"},"Phone",-1),Be=e("label",{for:"email"},"Email",-1),Re={class:"flex flex-row justify-end"},Ie=e("button",{type:"submit",class:"bg-blue-600 min-w-[100px]"}," Save ",-1),Ne=e("h2",{class:"text-xl p-4"},"Add Pickup",-1),je=e("label",{for:"first_name"},"Date",-1),Ge={class:"flex flex-row justify-end"},Oe=e("button",{type:"submit",class:"bg-blue-600 min-w-[100px]"}," Save ",-1),ze={class:"text-xl p-4"},Ke=e("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),Fe=e("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1),Le=[Ke,Fe],Me={class:"border-b"},Ye={class:"flex flex-row justify-between p-4"},qe=e("b",null,"Date:",-1),We=["onClick"],Ze={key:0,class:"flex flex-col justify-end p-4 text-center space-y-4"},He=e("p",null,"Are You Want To Delete This Pickup?",-1),Je={class:"flex text-bold"},st={__name:"View",setup(n){onMounted(()=>{store.dispatch("DataController","getRoute")});const l=t=>t?(t=new Date(t),t.setDate(t.getDate()+1),t=t.toLocaleDateString("en-US"),t):"",i=t=>{store.stop.street=`${t.street_number} ${t.route}`,store.stop.city=t.locality,store.stop.state=t.administrative_area_level_1,store.stop.zip=t.postal_code};return(t,s)=>(p(),C($,{title:"Dashboard"},{header:c(()=>[B]),default:c(()=>[e("div",R,[e("div",I,[e("div",N,[e("div",j,[e("h1",null,[G,f(" "+a(t.store.route.name)+" ",1),e("a",{class:"ml-4 text-blue-600",href:"/pdf/route/"+t.store.route.id},"Download",8,O)]),e("button",{onClick:s[0]||(s[0]=o=>t.store.routeEdit=!t.store.routeEdit)}," Edit ")]),t.store.routeEdit?(p(),m("form",{key:0,onSubmit:s[2]||(s[2]=y(o=>{t.store.submit("DataController","storeRoute",["route"]),t.store.routeEdit=!1},["prevent"]))},[e("div",null,[z,d(e("input",{type:"text",name:"name","onUpdate:modelValue":s[1]||(s[1]=o=>t.store.route.name=o)},null,512),[[u,t.store.route.name]])]),K],32)):h("",!0),e("div",F,[L,e("button",{onClick:s[3]||(s[3]=o=>{t.store.stopEdit=!t.store.stopEdit,t.store.stop={}})}," Add Stop ")]),(p(!0),m(_,null,v(t.store.stops,o=>(p(),m("div",M,[e("div",Y,[e("p",null,[q,f(" "+a(o.order),1)]),o.name?(p(),m("p",W,[Z,f(" "+a(o.name),1)])):h("",!0)]),e("div",H,[e("button",{class:"flex-1 bg-blue-600 text-white rounded shadow text-xs font-bold p-1",onClick:r=>{t.store.stop=o,t.store.stopEdit=!0}}," Edit Stop ",8,J),e("button",{class:"flex-1 bg-blue-600 text-white rounded shadow text-xs font-bold p-1",onClick:r=>{t.store.stop=o,t.store.contact={},t.store.contactEdit=!0}}," Add Contact ",8,Q),e("button",{class:"flex-1 bg-blue-600 text-white rounded shadow text-xs font-bold p-1",onClick:r=>{t.store.pickupEdit=!t.store.pickupEdit,t.store.pickup={},t.store.stop=o}}," Add Pickup ",8,X)]),e("div",null,[ee,e("p",null,[e("a",{href:"http://maps.google.com/?q="+o.street+" "+o.city+" "+o.state+" "+o.zip,target:"_blank"},a(o.street)+" "+a(o.street_2?`Apt: ${o.street_2}`:""),9,te)]),e("p",null,a(o.city)+", "+a(o.state)+" "+a(o.zip),1)]),e("div",null,[e("p",oe,[e("b",null," Contacts: "+a(o.contacts.length),1),e("button",{class:"text-blue-600",onClick:r=>t.store[`show-stop-${o.id}`]=!t.store[`show-stop-${o.id}`]}," Show ",8,se)]),t.store[`show-stop-${o.id}`]?(p(!0),m(_,{key:0},v(o.contacts,r=>(p(),m("div",null,[e("div",ne,[e("button",{class:"text-blue-600",onClick:Qe=>{t.store.contactEdit=!0,t.store.contact=r,t.store.stop=o}},a(r.first_name)+" "+a(r.last_name),9,le),e("a",{href:"tel:"+r.phone,class:"text-purple-800 block"},a(r.phone),9,ie),e("p",null,a(r.email),1)])]))),256)):h("",!0)]),e("div",null,[e("p",re,[e("b",null,"Pickups: "+a(o.pickups.length),1),e("button",{class:"text-blue-600",onClick:r=>t.store.viewPickup=o}," Show ",8,ae),e("span",null,[de,f(" "+a(o.pickups.length?l(o.pickups[0].date):"None"),1)])])])]))),256))])])]),b(g,{show:t.store.stopEdit},{default:c(()=>[e("div",ue,[pe,e("button",{class:"text-red-600",onClick:s[4]||(s[4]=o=>t.store.deleteStopConfirm=!t.store.deleteStopConfirm)}," Remove Stop ")]),t.store.deleteStopConfirm?(p(),m("div",me,[ce,e("button",{class:"text-red-600",onClick:s[5]||(s[5]=o=>{t.store.submit("DataController","deleteStop",["stop"]),t.store.stopEdit=!1})}," Delete Stop ")])):h("",!0),e("form",{onSubmit:s[14]||(s[14]=y(o=>{t.store.submit("DataController","storeStop",["stop","route"]),t.store.stopEdit=!1},["prevent"])),class:"p-4"},[e("div",fe,[e("div",he,[be,d(e("input",{type:"text",name:"name",id:"name","onUpdate:modelValue":s[6]||(s[6]=o=>t.store.stop.name=o)},null,512),[[u,t.store.stop.name]])]),e("div",ye,[ge,d(e("input",{type:"text",name:"order",id:"order","onUpdate:modelValue":s[7]||(s[7]=o=>t.store.stop.order=o)},null,512),[[u,t.store.stop.order]])])]),e("div",null,[ve,b(S(U),{id:"map",classname:"form-control",placeholder:"Start typing",onPlacechanged:i})]),e("div",null,[_e,d(e("input",{type:"text",name:"street",id:"street","onUpdate:modelValue":s[8]||(s[8]=o=>t.store.stop.street=o)},null,512),[[u,t.store.stop.street]])]),e("div",null,[ke,d(e("input",{type:"text",name:"street",id:"street","onUpdate:modelValue":s[9]||(s[9]=o=>t.store.stop.street_2=o)},null,512),[[u,t.store.stop.street_2]])]),e("div",we,[e("div",Ce,[Se,d(e("input",{type:"text",name:"city",id:"city","onUpdate:modelValue":s[10]||(s[10]=o=>t.store.stop.city=o)},null,512),[[u,t.store.stop.city]])]),e("div",$e,[Ee,d(e("input",{type:"text",name:"state",id:"state","onUpdate:modelValue":s[11]||(s[11]=o=>t.store.stop.state=o)},null,512),[[u,t.store.stop.state]])])]),e("div",null,[Pe,d(e("input",{type:"text",name:"zip",id:"zip","onUpdate:modelValue":s[12]||(s[12]=o=>t.store.stop.zip=o)},null,512),[[u,t.store.stop.zip]])]),e("div",xe,[e("button",{onClick:s[13]||(s[13]=o=>{t.store.stopEdit=!1,t.store.stop={}}),class:"bg-red-600"}," Cancel "),De])],32)]),_:1},8,["show"]),b(g,{show:t.store.contactEdit},{default:c(()=>[Ae,e("form",{onSubmit:s[20]||(s[20]=y(o=>{t.store.submit("DataController","storeContact",["stop","contact","route"]),t.store.contactEdit=!1},["prevent"])),class:"p-4"},[e("div",null,[Ve,d(e("input",{"onUpdate:modelValue":s[15]||(s[15]=o=>t.store.contact.first_name=o),type:"text",name:"first_name",id:"first_name"},null,512),[[u,t.store.contact.first_name]])]),e("div",null,[Te,d(e("input",{"onUpdate:modelValue":s[16]||(s[16]=o=>t.store.contact.last_name=o),type:"text",name:"last_name",id:"last_name"},null,512),[[u,t.store.contact.last_name]])]),e("div",null,[Ue,d(e("input",{"onUpdate:modelValue":s[17]||(s[17]=o=>t.store.contact.phone=o),type:"text",name:"phone",id:"phone"},null,512),[[u,t.store.contact.phone]])]),e("div",null,[Be,d(e("input",{"onUpdate:modelValue":s[18]||(s[18]=o=>t.store.contact.email=o),type:"text",name:"email",id:"email"},null,512),[[u,t.store.contact.email]])]),e("div",Re,[e("button",{type:"button",class:"bg-red-600 min-w-[100px]",onClick:s[19]||(s[19]=o=>{t.store.contactEdit=!1,t.store.stop={},t.store.contact={}})}," Cancel "),Ie])],32)]),_:1},8,["show"]),b(g,{show:t.store.pickupEdit},{default:c(()=>[Ne,e("form",{onSubmit:s[23]||(s[23]=y(o=>{t.store.submit("DataController","storePickup",["pickup","stop","route"]),t.store.pickupEdit=!1},["prevent"])),class:"p-4"},[e("div",null,[je,d(e("input",{"onUpdate:modelValue":s[21]||(s[21]=o=>t.store.pickup.date=o),type:"date",name:"first_name",id:"first_name"},null,512),[[u,t.store.pickup.date]])]),e("div",Ge,[e("button",{type:"button",class:"bg-red-600 min-w-[100px]",onClick:s[22]||(s[22]=o=>{t.store.pickupEdit=!1,t.store.stop={},t.store.pickup={}})}," Cancel "),Oe])],32)]),_:1},8,["show"]),b(g,{show:t.store.viewPickup,onClose:s[27]||(s[27]=o=>t.store.viewPickup=!1)},{default:c(()=>[e("div",null,[e("h2",ze,a(t.store.viewPickup.name)+" Pickups",1),(p(),m("svg",{onClick:s[24]||(s[24]=o=>{t.store.viewPickup=!1,t.store.deletePickupId=!1}),class:"absolute top-0 right-0 m-4 cursor-pointer",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#000000","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Le))]),e("div",null,[(p(!0),m(_,null,v(t.store.viewPickup.pickups,o=>(p(),m("div",Me,[e("div",Ye,[e("p",null,[qe,f(" "+a(l(o.date)),1)]),e("p",null,[e("button",{onClick:r=>t.store.deletePickupId=o.id}," Delete ",8,We)])]),t.store.deletePickupId===o.id?(p(),m("div",Ze,[He,e("div",Je,[e("button",{class:"flex-1 bg-gray-600 text-white",onClick:s[25]||(s[25]=r=>t.store.deletePickupId=!1)}," Cancel "),e("button",{class:"bg-blue-600 text-white flex-1",onClick:s[26]||(s[26]=r=>{t.store.submit("DataController","deletePickup",["deletePickupId","viewPickup","route"]),t.store.viewPickup=!1,t.store.deletePickupId=!1})}," Delete ")])])):h("",!0)]))),256))])]),_:1},8,["show"])]),_:1}))}};export{st as default};
