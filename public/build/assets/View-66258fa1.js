import{k as d,C as u,o as p,d as m,n as w,c as k,w as c,a as t,f as b,t as r,h as f,e as y,g as _,F as v,b as h,u as S}from"./app-8edd1505.js";import{_ as E}from"./AppLayout-d7294ec2.js";import{_ as g}from"./Modal-432cad61.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";const C={subpremise:"short_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name"},x=["locality","administrative_area_level_3"],V=["locality","sublocality","postal_code","country","administrative_area_level_1","administrative_area_level_2"],A=["address_components","adr_address","alt_id","formatted_address","geometry","icon","id","name","business_status","photo","place_id","scope","type","url","utc_offset_minutes","vicinity"],D={name:"VueGoogleAutocomplete",props:{id:{type:String,required:!0},classname:String,placeholder:{type:String,default:"Start typing"},disabled:{type:Boolean,default:!1},types:{type:String,default:"address"},fields:{type:Array,default:function(){return A}},country:{type:[String,Array],default:null},enableGeolocation:{type:Boolean,default:!1},geolocationOptions:{type:Object,default:null}},data(){return{autocomplete:null,autocompleteText:"",geolocation:{geocoder:null,loc:null,position:null}}},watch:{autocompleteText:function(n,l){this.$emit("inputChange",{newVal:n,oldVal:l},this.id)},country:function(n,l){this.autocomplete.setComponentRestrictions({country:this.country===null?[]:this.country})}},mounted:function(){const n={};this.types&&(n.types=[this.types]),this.country&&(n.componentRestrictions={country:this.country}),this.autocomplete=new google.maps.places.Autocomplete(document.getElementById(this.id),n),this.autocomplete.setFields(this.fields),this.autocomplete.addListener("place_changed",this.onPlaceChanged)},methods:{onPlaceChanged(){let n=this.autocomplete.getPlace();if(!n.geometry){this.$emit("no-results-found",n,this.id);return}n.address_components!==void 0&&(this.$emit("placechanged",this.formatResult(n),n,this.id),this.autocompleteText=document.getElementById(this.id).value,this.onChange())},onFocus(){this.biasAutocompleteLocation(),this.$emit("focus")},onBlur(){this.$emit("blur")},onChange(){this.$emit("change",this.autocompleteText)},onKeyPress(n){this.$emit("keypress",n)},onKeyUp(n){this.$emit("keyup",n)},clear(){this.autocompleteText=""},focus(){this.$refs.autocomplete.focus()},blur(){this.$refs.autocomplete.blur()},update(n){this.autocompleteText=n},updateCoordinates(n){!n&&!(n.lat||n.lng)||(this.geolocation.geocoder||(this.geolocation.geocoder=new google.maps.Geocoder),this.geolocation.geocoder.geocode({location:n},(l,i)=>{i==="OK"?(l=this.filterGeocodeResultTypes(l),l[0]?(this.$emit("placechanged",this.formatResult(l[0]),l[0],this.id),this.update(l[0].formatted_address)):this.$emit("error","no result for provided coordinates")):this.$emit("error","error getting address from coords")}))},geolocate(){this.updateGeolocation((n,l)=>{this.updateCoordinates(n)})},updateGeolocation(n=null){if(navigator.geolocation){let l={};this.geolocationOptions&&Object.assign(l,this.geolocationOptions),navigator.geolocation.getCurrentPosition(i=>{let e={lat:i.coords.latitude,lng:i.coords.longitude};this.geolocation.loc=e,this.geolocation.position=i,n&&n(e,i)},i=>{this.$emit("error","Cannot get Coordinates from navigator",i)},l)}},biasAutocompleteLocation(){this.enableGeolocation&&this.updateGeolocation((n,l)=>{let i=new google.maps.Circle({center:n,radius:l.coords.accuracy});this.autocomplete.setBounds(i.getBounds())})},formatResult(n){let l={};for(let i=0;i<n.address_components.length;i++){let e=n.address_components[i].types[0];if(C[e]){let s=n.address_components[i][C[e]];l[e]=s}}return l.latitude=n.geometry.location.lat(),l.longitude=n.geometry.location.lng(),l},filterGeocodeResultTypes(n){if(!n||!this.types)return n;let l=[],i=[this.types];i.includes("(cities)")&&(i=i.concat(x)),i.includes("(regions)")&&(i=i.concat(V));for(let e of n)for(let s of e.types)if(i.includes(s)){l.push(e);break}return l}}},T=["id","placeholder","disabled"];function U(n,l,i,e,s,o){return d((p(),m("input",{ref:"autocomplete",type:"text",class:w(i.classname),id:i.id,placeholder:i.placeholder,disabled:i.disabled,"onUpdate:modelValue":l[0]||(l[0]=a=>s.autocompleteText=a),onFocus:l[1]||(l[1]=a=>o.onFocus()),onBlur:l[2]||(l[2]=a=>o.onBlur()),onChange:l[3]||(l[3]=(...a)=>o.onChange&&o.onChange(...a)),onKeypress:l[4]||(l[4]=(...a)=>o.onKeyPress&&o.onKeyPress(...a)),onKeyup:l[5]||(l[5]=(...a)=>o.onKeyUp&&o.onKeyUp(...a))},null,42,T)),[[u,s.autocompleteText]])}const P=$(D,[["render",U]]),B=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Route Info ",-1),R={class:"py-12"},N={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},G={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-4"},O={class:"flex justify-between"},j=t("b",null," Route: ",-1),z=t("label",{for:"name"},"Route Name",-1),K=t("div",null,[t("button",{type:"submit",class:"bg-blue-600"}," Save ")],-1),F={class:"flex justify-between my-6"},I=t("h1",null,[t("b",null," Stops ")],-1),L={class:"mb-6 border p-4 rounded shadow-sm flex flex-col space-y-4 max-w-xl"},M={class:"flex flex-col items-center space-y-2"},q=t("b",null," Stop: ",-1),Y={key:0},Z=t("b",null,"Name:",-1),H={class:"flex justify-between space-x-2"},J=["onClick"],Q=["onClick"],W=["onClick"],X=t("p",null,[t("b",null," Address: ")],-1),tt=["href"],et={class:"flex space-x-4"},ot=["onClick"],st={class:"my-2 flex items-center space-x-2 flex-wrap"},nt=["onClick"],lt=["href"],it={class:"flex space-x-4"},at=t("b",null,"Pickup:",-1),rt={class:"flex items-center justify-between p-4"},dt=t("h2",{class:"text-xl"},"Add Stop",-1),ut={class:"flex flex-row space-x-4"},pt={class:"w-8/12"},mt=t("label",{for:"name"},"Name",-1),ct={class:"w-4/12"},ft=t("label",{for:"order"},"Order",-1),ht=t("label",{for:"map"},"Search Address",-1),bt=t("label",{for:"street"},"Street",-1),yt=t("label",{for:"street"},"Apt #",-1),gt={class:"flex flex-row space-x-4"},_t={class:"w-8/12"},vt=t("label",{for:"city"},"City",-1),Ct={class:"w-4/12"},wt=t("label",{for:"state"},"State",-1),kt=t("label",{for:"zip"},"Zip",-1),St={class:"flex flex-row justify-end"},Et=t("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-700"}," Add Stop ",-1),$t=t("h2",{class:"text-xl p-4"},"Contact",-1),xt=t("label",{for:"first_name"},"First Name",-1),Vt=t("label",{for:"last_name"},"Last Name",-1),At=t("label",{for:"phone"},"Phone",-1),Dt=t("label",{for:"email"},"Email",-1),Tt={class:"flex flex-row justify-end"},Ut=t("button",{type:"submit",class:"bg-blue-600 min-w-[100px]"}," Save ",-1),Pt=t("h2",{class:"text-xl p-4"},"Add Pickup",-1),Bt=t("label",{for:"first_name"},"Date",-1),Rt={class:"flex flex-row justify-end"},Nt=t("button",{type:"submit",class:"bg-blue-600 min-w-[100px]"}," Save ",-1),Ft={__name:"View",setup(n){onMounted(()=>{store.dispatch("DataController","getRoute")});const l=e=>e?(e=new Date(e),e.setDate(e.getDate()+1),e=e.toLocaleDateString("en-US"),e):"",i=e=>{store.stop.street=`${e.street_number} ${e.route}`,store.stop.city=e.locality,store.stop.state=e.administrative_area_level_1,store.stop.zip=e.postal_code};return(e,s)=>(p(),k(E,{title:"Dashboard"},{header:c(()=>[B]),default:c(()=>[t("div",R,[t("div",N,[t("div",G,[t("div",O,[t("h1",null,[j,b(" "+r(e.store.route.name),1)]),t("button",{onClick:s[0]||(s[0]=o=>e.store.routeEdit=!e.store.routeEdit)}," Edit ")]),e.store.routeEdit?(p(),m("form",{key:0,onSubmit:s[2]||(s[2]=f(o=>{e.store.submit("DataController","storeRoute",["route"]),e.store.routeEdit=!1},["prevent"]))},[t("div",null,[z,d(t("input",{type:"text",name:"name","onUpdate:modelValue":s[1]||(s[1]=o=>e.store.route.name=o)},null,512),[[u,e.store.route.name]])]),K],32)):y("",!0),t("div",F,[I,t("button",{onClick:s[3]||(s[3]=o=>{e.store.stopEdit=!e.store.stopEdit,e.store.stop={}})}," Add Stop ")]),(p(!0),m(v,null,_(e.store.stops,o=>(p(),m("div",L,[t("div",M,[t("p",null,[q,b(" "+r(o.order),1)]),o.name?(p(),m("p",Y,[Z,b(" "+r(o.name),1)])):y("",!0)]),t("div",H,[t("button",{class:"flex-1 bg-blue-600 text-white rounded shadow text-xs font-bold p-1",onClick:a=>{e.store.stop=o,e.store.stopEdit=!0}}," Edit Stop ",8,J),t("button",{class:"flex-1 bg-blue-600 text-white rounded shadow text-xs font-bold p-1",onClick:a=>{e.store.stop=o,e.store.contact={},e.store.contactEdit=!0}}," Add Contact ",8,Q),t("button",{class:"flex-1 bg-blue-600 text-white rounded shadow text-xs font-bold p-1",onClick:a=>{e.store.pickupEdit=!e.store.pickupEdit,e.store.pickup={},e.store.stop=o}}," Add Pickup ",8,W)]),t("div",null,[X,t("p",null,[t("a",{href:"http://maps.google.com/?q="+o.street+" "+o.city+" "+o.state+" "+o.zip,target:"_blank"},r(o.street)+" "+r(o.street_2?`Apt: ${o.street_2}`:""),9,tt)]),t("p",null,r(o.city)+", "+r(o.state)+" "+r(o.zip),1)]),t("div",null,[t("p",et,[t("b",null," Contacts: "+r(o.contacts.length),1),t("button",{class:"text-blue-600",onClick:a=>e.store[`show-stop-${o.id}`]=!e.store[`show-stop-${o.id}`]}," Show ",8,ot)]),e.store[`show-stop-${o.id}`]?(p(!0),m(v,{key:0},_(o.contacts,a=>(p(),m("div",null,[t("div",st,[t("button",{class:"text-blue-600",onClick:Gt=>{e.store.contactEdit=!0,e.store.contact=a,e.store.stop=o}},r(a.first_name)+" "+r(a.last_name),9,nt),t("a",{href:"tel:"+a.phone,class:"text-purple-800 block"},r(a.phone),9,lt),t("p",null,r(a.email),1)])]))),256)):y("",!0)]),t("div",null,[t("p",it,[at,t("span",null,r(o.pickups.length?l(o.pickups[0].date):"None"),1)])])]))),256))])])]),h(g,{show:e.store.stopEdit},{default:c(()=>[t("div",rt,[dt,t("button",{class:"text-red-600",onClick:s[4]||(s[4]=o=>{e.store.submit("DataController","deleteStop",["stop"]),e.store.stopEdit=!1})}," Delete Stop ")]),t("form",{onSubmit:s[13]||(s[13]=f(o=>{e.store.submit("DataController","storeStop",["stop","route"]),e.store.stopEdit=!1},["prevent"])),class:"p-4"},[t("div",ut,[t("div",pt,[mt,d(t("input",{type:"text",name:"name",id:"name","onUpdate:modelValue":s[5]||(s[5]=o=>e.store.stop.name=o)},null,512),[[u,e.store.stop.name]])]),t("div",ct,[ft,d(t("input",{type:"text",name:"order",id:"order","onUpdate:modelValue":s[6]||(s[6]=o=>e.store.stop.order=o)},null,512),[[u,e.store.stop.order]])])]),t("div",null,[ht,h(S(P),{id:"map",classname:"form-control",placeholder:"Start typing",onPlacechanged:i})]),t("div",null,[bt,d(t("input",{type:"text",name:"street",id:"street","onUpdate:modelValue":s[7]||(s[7]=o=>e.store.stop.street=o)},null,512),[[u,e.store.stop.street]])]),t("div",null,[yt,d(t("input",{type:"text",name:"street",id:"street","onUpdate:modelValue":s[8]||(s[8]=o=>e.store.stop.street_2=o)},null,512),[[u,e.store.stop.street_2]])]),t("div",gt,[t("div",_t,[vt,d(t("input",{type:"text",name:"city",id:"city","onUpdate:modelValue":s[9]||(s[9]=o=>e.store.stop.city=o)},null,512),[[u,e.store.stop.city]])]),t("div",Ct,[wt,d(t("input",{type:"text",name:"state",id:"state","onUpdate:modelValue":s[10]||(s[10]=o=>e.store.stop.state=o)},null,512),[[u,e.store.stop.state]])])]),t("div",null,[kt,d(t("input",{type:"text",name:"zip",id:"zip","onUpdate:modelValue":s[11]||(s[11]=o=>e.store.stop.zip=o)},null,512),[[u,e.store.stop.zip]])]),t("div",St,[t("button",{onClick:s[12]||(s[12]=o=>{e.store.stopEdit=!1,e.store.stop={}}),class:"bg-red-600"}," Cancel "),Et])],32)]),_:1},8,["show"]),h(g,{show:e.store.contactEdit},{default:c(()=>[$t,t("form",{onSubmit:s[19]||(s[19]=f(o=>{e.store.submit("DataController","storeContact",["stop","contact","route"]),e.store.contactEdit=!1},["prevent"])),class:"p-4"},[t("div",null,[xt,d(t("input",{"onUpdate:modelValue":s[14]||(s[14]=o=>e.store.contact.first_name=o),type:"text",name:"first_name",id:"first_name"},null,512),[[u,e.store.contact.first_name]])]),t("div",null,[Vt,d(t("input",{"onUpdate:modelValue":s[15]||(s[15]=o=>e.store.contact.last_name=o),type:"text",name:"last_name",id:"last_name"},null,512),[[u,e.store.contact.last_name]])]),t("div",null,[At,d(t("input",{"onUpdate:modelValue":s[16]||(s[16]=o=>e.store.contact.phone=o),type:"text",name:"phone",id:"phone"},null,512),[[u,e.store.contact.phone]])]),t("div",null,[Dt,d(t("input",{"onUpdate:modelValue":s[17]||(s[17]=o=>e.store.contact.email=o),type:"text",name:"email",id:"email"},null,512),[[u,e.store.contact.email]])]),t("div",Tt,[t("button",{type:"button",class:"bg-red-600 min-w-[100px]",onClick:s[18]||(s[18]=o=>{e.store.contactEdit=!1,e.store.stop={},e.store.contact={}})}," Cancel "),Ut])],32)]),_:1},8,["show"]),h(g,{show:e.store.pickupEdit},{default:c(()=>[Pt,t("form",{onSubmit:s[22]||(s[22]=f(o=>{e.store.submit("DataController","storePickup",["pickup","stop","route"]),e.store.pickupEdit=!1},["prevent"])),class:"p-4"},[t("div",null,[Bt,d(t("input",{"onUpdate:modelValue":s[20]||(s[20]=o=>e.store.pickup.date=o),type:"date",name:"first_name",id:"first_name"},null,512),[[u,e.store.pickup.date]])]),t("div",Rt,[t("button",{type:"button",class:"bg-red-600 min-w-[100px]",onClick:s[21]||(s[21]=o=>{e.store.pickupEdit=!1,e.store.stop={},e.store.pickup={}})}," Cancel "),Nt])],32)]),_:1},8,["show"])]),_:1}))}};export{Ft as default};
